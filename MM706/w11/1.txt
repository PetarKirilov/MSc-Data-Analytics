Possilbe sols

proc format;
value typefmt 1 = 'cash' 2 = 'credit';
run;
data customers;
set 'C:\Users\pkk11\Downloads\customers';
format type typefmt.;
run;
data invoices;
set 'C:\Users\pkk11\Downloads\invoices';
run;
proc sort data = customers;
by name;
run;
proc sort data = invoices;
by name;
run;
proc means data = invoices noprint;
var amount;
by name;
output out = meanamount n = noinvoices sum = totalamount mean = meaninvoices;
proc print data = meanamount noobs;
var name noinvoices totalamount meaninvoices;
run;
data 'M:\SAS Working area\meanamount';
set meanamount;
drop _TYPE_ _FREQ_;
run;
data merged;
drop _TYPE_ _FREQ_;
merge customers meanamount;
by name;
run;
proc sgplot data = merged;
scatter x = meaninvoices y = age;
run;
proc means data = merged noprint;
var meaninvoices;
by type;
output out = meantype n = type mean = meantype1;
proc print data = meantype noobs;
var type meantype1;
run;
data 'M:\SAS Working area\meantype';
set meantype;
drop _TYPE_ _FREQ_;
run;
data spend1;
set merged;
if (meaninvoices > 40) then spend = 'high';
else spend = 'low'; 
run;

